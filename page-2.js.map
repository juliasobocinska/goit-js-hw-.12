{"version":3,"file":"page-2.js","sources":["../src/search-form.js"],"sourcesContent":["// Opisany w dokumentacji\nimport iziToast from \"izitoast\";\n// Opcjonalny import stylów\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Opisany w dokumentacji\nimport SimpleLightbox from \"simplelightbox\";\n// Opcjonalny import stylów\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n// Opisany w dokumentacji\nimport axios from 'axios';\n\nconst fetchPostsBtn = document.querySelector(\".btn\");\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\n\n// Zmienna lightbox\nlet lightbox;\n\nlet keyWord = \"\";\nlet page = 1;\nconst perPage = 40;\n\n// Funkcja do pobierania galerii\nconst fetchGallery = async () => { \n    const searchParams = new URLSearchParams({\n        key: \"46327041-9a6335f12388e2a1236167102\",\n        q: keyWord,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: perPage,\n        page: page,\n    });\n    \n    const url = `https://pixabay.com/api/?${searchParams}`;\n    \n    try { \n        loader.style.display = 'block'; // Pokazuje loader\n        const response = await axios.get(url); // Wysyła zapytanie do API\n        const data = response.data;\n\n        if (Array.isArray(data.hits) && data.hits.length === 0) {\n            iziToast.error({\n                title: false,\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight'\n            });\n            return;\n        }\n        \n        const markup = data.hits.map((image) => {\n            return `\n            <div class=\"card\">\n                <a href=\"${image.largeImageURL}\" class=\"lightbox\" title=\"${image.tags}\">\n                    <img src=\"${image.webformatURL}\" alt=\"${image.tags}\"></img>\n                </a>\n                <div class=\"container-box\">\n                <p class=\"desc\"><span class=\"count\">Likes:</span> ${image.likes}</p>\n                <p class=\"desc\"><span class=\"count\">Views:</span> ${image.views}</p>\n                    <p class=\"desc\"><span class=\"count\">Comments:</span> ${image.comments}</p>\n                    <p class=\"desc\"><span class=\"count\">Downloads:</span> ${image.downloads}</p>\n                </div>\n                </div>\n            `;\n        }).join(\"\");\n\n        // Dodaj obrazy do galerii\n        gallery.innerHTML = page === 1 ? markup : gallery.innerHTML + markup;\n\n        // Inicjalizacja lightboxa\n        lightbox = new SimpleLightbox('.gallery a', {\n            captionsData: \"alt\",\n            sourceAttr: \"href\",\n            captions: true,\n            captionDelay: 250\n        });\n        \n        lightbox.refresh(); \n        \n        if(data.totalHits <= gallery.childElementCount) {\n            fetchPostsBtn.style.display = \"none\";    \n            return iziToast.info({\n                position: \"topRight\",\n                message: \"We're sorry, there are no more posts to load\"\n            });\n        } else {\n            fetchPostsBtn.style.display = \"block\";\n        }\n\n        //płynne scrollowanie\n        const cards = document.querySelectorAll(\".card\");\n        if(cards.length > 0) {\n            const cardsHeight = cards[0].getBoundingClientRect().height;\n                window.scrollBy(0, 2 * cardsHeight);\n        }\n        \n    } catch (error) {\n        console.log('There has been a problem with your fetch operation:', error);\n    } finally {\n        loader.style.display = 'none'; \n    }\n    \n};\n\n// Obsługa kliknięcia przycisku wyszukiwania\ndocument.getElementById('searchButton').addEventListener('click', async function(event) {\n    event.preventDefault();\n    keyWord = document.getElementById('searchInput').value; \n    page = 1; \n    gallery.innerHTML = ''; \n    fetchPostsBtn.style.display = \"block\";\n    //pobieranie galerii\n    await fetchGallery(); \n});\n\n// Obsługa kliknięcia przycisku \"Load more\"\nfetchPostsBtn.addEventListener('click', async () => {\n    page += 1; \n    await fetchGallery(); \n\n    \n});\n// Zamykanie okna modalnego za pomocą klawiszy\ndocument.addEventListener(\"keydown\", e => {\n    if (e.key === \"Escape\" && lightbox) {\n        lightbox.close();\n    }\n});\n\n"],"names":["fetchPostsBtn","loader","gallery","lightbox","keyWord","page","perPage","fetchGallery","url","data","axios","iziToast","markup","image","SimpleLightbox","cards","cardsHeight","error","event","e"],"mappings":"sJAaA,MAAMA,EAAgB,SAAS,cAAc,MAAM,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,UAAU,EAGjD,IAAIC,EAEAC,EAAU,GACVC,EAAO,EACX,MAAMC,EAAU,GAGVC,EAAe,SAAY,CAW7B,MAAMC,EAAM,4BAVS,IAAI,gBAAgB,CACrC,IAAK,qCACL,EAAGJ,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUE,EACV,KAAMD,CACd,CAAK,CAEmD,GAEpD,GAAI,CACAJ,EAAO,MAAM,QAAU,QAEvB,MAAMQ,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAEtB,GAAI,MAAM,QAAQC,EAAK,IAAI,GAAKA,EAAK,KAAK,SAAW,EAAG,CACpDE,EAAS,MAAM,CACX,MAAO,GACP,QAAS,2EACT,SAAU,UAC1B,CAAa,EACD,MACH,CAED,MAAMC,EAASH,EAAK,KAAK,IAAKI,GACnB;AAAA;AAAA,2BAEQA,EAAM,aAAa,6BAA6BA,EAAM,IAAI;AAAA,gCACrDA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,oEAGFA,EAAM,KAAK;AAAA,oEACXA,EAAM,KAAK;AAAA,2EACJA,EAAM,QAAQ;AAAA,4EACbA,EAAM,SAAS;AAAA;AAAA;AAAA,aAIlF,EAAE,KAAK,EAAE,EAeV,GAZAX,EAAQ,UAAYG,IAAS,EAAIO,EAASV,EAAQ,UAAYU,EAG9DT,EAAW,IAAIW,EAAe,aAAc,CACxC,aAAc,MACd,WAAY,OACZ,SAAU,GACV,aAAc,GAC1B,CAAS,EAEDX,EAAS,QAAO,EAEbM,EAAK,WAAaP,EAAQ,kBACzB,OAAAF,EAAc,MAAM,QAAU,OACvBW,EAAS,KAAK,CACjB,SAAU,WACV,QAAS,8CACzB,CAAa,EAEDX,EAAc,MAAM,QAAU,QAIlC,MAAMe,EAAQ,SAAS,iBAAiB,OAAO,EAC/C,GAAGA,EAAM,OAAS,EAAG,CACjB,MAAMC,EAAcD,EAAM,CAAC,EAAE,sBAAqB,EAAG,OACjD,OAAO,SAAS,EAAG,EAAIC,CAAW,CACzC,CAEJ,OAAQC,EAAO,CACZ,QAAQ,IAAI,sDAAuDA,CAAK,CAChF,QAAc,CACNhB,EAAO,MAAM,QAAU,MAC1B,CAEL,EAGA,SAAS,eAAe,cAAc,EAAE,iBAAiB,QAAS,eAAeiB,EAAO,CACpFA,EAAM,eAAc,EACpBd,EAAU,SAAS,eAAe,aAAa,EAAE,MACjDC,EAAO,EACPH,EAAQ,UAAY,GACpBF,EAAc,MAAM,QAAU,QAE9B,MAAMO,EAAY,CACtB,CAAC,EAGDP,EAAc,iBAAiB,QAAS,SAAY,CAChDK,GAAQ,EACR,MAAME,EAAY,CAGtB,CAAC,EAED,SAAS,iBAAiB,UAAWY,GAAK,CAClCA,EAAE,MAAQ,UAAYhB,GACtBA,EAAS,MAAK,CAEtB,CAAC"}